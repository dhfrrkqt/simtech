<!doctype html>
<!-- 이 문서는 'Test Agents' 웹 애플리케이션의 메인 레이아웃을 정의합니다. -->
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Test Agents Client</title>
  <!-- 외부 스타일시트 연결 -->
  <link rel="stylesheet" href="styles.css" />
  <!-- 구글 폰트 사전 연결 및 스타일시트 로드 -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Newsreader:wght@400;600;700&display=swap"
    rel="stylesheet" />
</head>

<body>
  <!-- 배경 효과 요소들 -->
  <div class="bg-glow"></div>
  <div class="bg-lines"></div>

  <main class="shell">
    <!-- 상단 헤더 영역: 브랜드 로고 및 입력 모드 토글 -->
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">TA</div>
        <div>
          <p class="brand-title">Test Agents</p>
          <p class="brand-sub">Client Console</p>
        </div>
      </div>
      <!-- 채팅/음성 모드 전환 버튼 -->
      <div class="mode-toggle" aria-label="Input mode">
        <button class="toggle-btn is-active" data-mode="chat">Chat</button>
        <button class="toggle-btn" data-mode="voice">Voice</button>
      </div>
    </header>

    <!-- 히어로 섹션: 서비스 소개 및 세션 시작/리셋 버튼 -->
    <section class="hero">
      <div class="hero-copy">
        <p class="eyebrow">Scenario Client</p>
        <h1>Practice the pitch like a live session.</h1>
        <p class="hero-note">
          This client is structured like a mini-lesson. Each stage gives you a
          target prompt, then you practice the response in chat or voice mode.
        </p>
        <div class="hero-actions">
          <!-- 세션 시작 버튼 -->
          <button class="primary" id="startBtn">Start Session</button>
          <!-- 세션 초기화 버튼 -->
          <button class="ghost" id="resetBtn">Reset</button>
        </div>
      </div>
      <!-- 시나리오 라이브러리 카드 -->
      <div class="hero-card">
        <p class="card-title">Scenario Library</p>
        <div class="scenario-grid">
          <button class="scenario-card is-active" data-scenario="standup">
            <span class="pill">01</span>
            <h2>Startup Standup 2.0: The Bottleneck Breaker</h2>
            <p>SusHi Tech Tokyo 2026 networking lounge conversation with Sarah (VC).</p>
          </button>
        </div>
      </div>
    </section>

    <!-- 작업 영역: 채팅 인터페이스와 설정/상태 정보 사이드바 -->
    <section class="workspace">
      <!-- 채팅 영역 -->
      <div class="chat">
        <div class="chat-header">
          <div>
            <p class="chat-title">Live Session</p>
            <p class="chat-sub" id="stageLabel">
              The Approach - Ask to sit down.
            </p>
          </div>
          <div class="session-chip">
            <span class="dot"></span>
            <span>Local demo</span>
          </div>
        </div>
        <!-- 메시지가 표시되는 몸체 영역 -->
        <div class="chat-body" id="chatBody"></div>
        <!-- 텍스트 입력창 영역 -->
        <div class="chat-input" id="chatInputRow">
          <input id="chatInput" type="text" placeholder="Type your response" autocomplete="off" />
          <button id="sendBtn">Send</button>
        </div>
        <!-- 음성 녹음 패널 (음성 모드 전용) -->
        <div class="voice-panel" id="voicePanel">
          <button class="primary" id="voiceBtn">Record 5s</button>
          <p class="voice-note" id="voiceStatus">
            Voice input records audio and sends it to the server for Whisper STT.
          </p>
        </div>
      </div>

      <!-- 사이드바 정보 영역 (인스펙터) -->
      <aside class="inspector">
        <!-- 세션 설정 카드 -->
        <div class="inspector-card">
          <p class="inspector-title">Session Settings</p>
          <form class="settings" id="settingsForm">
            <label class="field">
              <span>Timeout (seconds)</span>
              <input type="number" id="timeoutInput" min="30" max="600" step="10" value="240" />
            </label>
            <label class="field">
              <span>Record length (seconds)</span>
              <input type="number" id="recordSecondsInput" min="2" max="15" step="1" value="5" />
            </label>
            <label class="field field-inline">
              <input type="checkbox" id="ttsToggle" />
              <span>Enable TTS output</span>
            </label>
            <div class="field">
              <span>Input mode</span>
              <div class="radio-group">
                <label>
                  <input type="radio" name="inputMode" value="chat" checked />
                  Chat
                </label>
                <label>
                  <input type="radio" name="inputMode" value="voice" />
                  Voice
                </label>
              </div>
            </div>
            <button class="primary" type="submit">Apply Settings</button>
            <p class="form-note">
              These mirror `.env` values for timeout, TTS, and input mode.
            </p>
          </form>
        </div>
        <!-- 시나리오 현재 상태 카드 -->
        <div class="inspector-card">
          <p class="inspector-title">Scenario State</p>
          <div class="stat-list">
            <div class="stat">
              <span>Stage</span>
              <strong id="stageCount">1 / 4</strong>
            </div>
            <div class="stat">
              <span>Mode</span>
              <strong id="modeLabel">Chat</strong>
            </div>
            <div class="stat">
              <span>Status</span>
              <strong id="sessionStatus">Idle</strong>
            </div>
          </div>
        </div>
        <!-- 환경 설정 정보 카드 -->
        <div class="inspector-card">
          <p class="inspector-title">Environment</p>
          <div class="stat-list">
            <div class="stat">
              <span>Timeout</span>
              <strong id="envTimeout">240s</strong>
            </div>
            <div class="stat">
              <span>TTS</span>
              <strong id="envTts">Off</strong>
            </div>
            <div class="stat">
              <span>Input</span>
              <strong id="envMode">Chat</strong>
            </div>
            <div class="stat">
              <span>Record</span>
              <strong id="envRecord">5s</strong>
            </div>
          </div>
        </div>
        <!-- 현재 단계의 프롬프트 정보 -->
        <div class="inspector-card">
          <p class="inspector-title">Prompt</p>
          <p class="prompt-text" id="promptText">
            At the SusHi Tech Tokyo 2026 startup lounge, you spot an empty seat in a
            crowded area. Do you ask to sit?
          </p>
        </div>
        <!-- 평가 및 점수 카드 -->
        <div class="inspector-card">
          <p class="inspector-title">Evaluation</p>
          <div class="score-panel">
            <span>Score</span>
            <strong id="scoreValue">--</strong>
          </div>
          <p class="score-note" id="scoreNote">
            Score updates after the session ends.
          </p>
        </div>
        <!-- CLI 도움말 코드 샘플 -->
        <div class="inspector-card">
          <p class="inspector-title">CLI</p>
          <code class="cli">python main.py</code>
          <code class="cli">SCENARIO_INPUT_MODE=voice</code>
        </div>
      </aside>
    </section>
  </main>

  <!-- 시나리오 선택 모달(팝업) 창 -->
  <div id="scenarioModal" class="modal-overlay">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Select Your Experience</h2>
        <!-- 모달 닫기 버튼 -->
        <button id="closeModal" class="close-btn">&times;</button>
      </header>

      <!-- 시나리오들을 가로로 배치하기 위한 컨테이너 -->
      <div class="scenario-options-container">
        <!-- 1. 비즈니스 시나리오 (현재 사용 가능) -->
        <div class="scenario-option-card">
          <h3>Business</h3>
          <p class="scenario-desc">
            Networking at the SusHi Tech Tokyo 2026 lounge.
            Find Sarah, a VC, and practice your pitch in a realistic business environment.
          </p>
          <button class="primary select-scenario-btn" data-scenario="business">Select</button>
        </div>

        <!-- 2. 일상 시나리오 (준비 중) -->
        <div class="scenario-option-card is-locked">
          <h3>Daily Life</h3>
          <p class="scenario-desc">Coming Soon</p>
          <button class="ghost" disabled>Locked</button>
        </div>

        <!-- 3. 산업 시나리오 (준비 중) -->
        <div class="scenario-option-card is-locked">
          <h3>Industry</h3>
          <p class="scenario-desc">Coming Soon</p>
          <button class="ghost" disabled>Locked</button>
        </div>
      </div>
    </div>
    <!-- API 선택 모달 (시나리오 선택 후 노출) -->
    <div id="apiModal" class="modal-overlay">
      <div class="modal-content">
        <header class="modal-header">
          <h2>Select AI Provider</h2>
          <!-- 모달 닫기 버튼 -->
          <button id="closeApiModal" class="close-btn">&times;</button>
        </header>

        <div class="scenario-options-container">
          <!-- 1. Gemini API 선택 -->
          <div class="scenario-option-card">
            <h3>Gemini API</h3>
            <p class="scenario-desc">
              Fast and intuitive. Values the overall atmosphere and natural communication of your responses.
            </p>
            <button class="primary select-api-btn" data-api="gemini">Select Gemini</button>
          </div>

          <!-- 2. OpenAI API 선택 -->
          <div class="scenario-option-card">
            <h3>OpenAI API</h3>
            <p class="scenario-desc">
              Detailed and precise. Focuses on logical consistency, professional vocabulary, and structural accuracy.
            </p>
            <button class="primary select-api-btn" data-api="openai">Select OpenAI</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 애플리케이션 로직을 담당하는 자바스크립트 파일 연결 -->
    <!-- 모든 HTML 요소가 파싱된 후 실행되도록 하단에 배치하고 defer 속성 추가 -->
    <script src="app.js" defer></script>
</body>

</html>